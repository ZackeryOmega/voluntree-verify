<!DOCTYPE html>
<html>
<head>
  <title>Email Verification</title>
  <script>
    async function verifyEmail() {
      // Extract token from URL fragment (#)
      const hash = window.location.hash.substring(1);
      const params = new URLSearchParams(hash);
      const token = params.get('token');
      const type = params.get('type');
      
      if (!token || type !== 'signup') {
        document.getElementById('message').innerText = 'Invalid link';
        return;
      }
      
      try {
        const response = await fetch(
          `https://yootdndwvhufhwiebrqu.supabase.co/auth/v1/verify?token=${token}&type=${type}`,
          { method: 'GET' }
        );
        
        const data = await response.json();
        if (data.access_token) {
          document.getElementById('message').innerText = 'Email verified successfully!';
          
          // Optional: Redirect to app after verification
          setTimeout(() => {
            window.location.href = 'voluntree://verified';
          }, 3000);
          
        } else {
          throw new Error(data.error_description || 'Verification failed');
        }
      } catch (error) {
        document.getElementById('message').innerText = error.message;
      }
    }
    window.onload = verifyEmail;
  </script>
</head>
<body>
  <div id="message">Verifying your email...</div>
</body>
</html>
